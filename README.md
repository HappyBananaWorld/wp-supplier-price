# XYZ Supplier Discount

## توضیح کلی
این افزونه یک فیلد **درصد تخفیف تأمین‌کننده** برای محصولات ووکامرس اضافه می‌کند و **برای کاربران با نقش `supplier`** قیمت را با درصد تخفیف نمایش می‌دهد.  
همه تغییرات فقط از طریق افزونه انجام می‌شود و فایل قالب دست‌نخورده باقی می‌ماند.

---

## امکانات اصلی
- افزودن فیلد در پنل ادمین برای محصولات ساده و متغیرها.
- اعتبارسنجی عددی بین **0 تا 100**.
- نمایش قیمت تخفیف‌خورده **فقط** برای نقش `supplier`.
- ذخیره در متای محصول با کلید مشخص و بدون تداخل با سایر نقش‌ها.

---

## نصب
1. پوشه افزونه را در `wp-content/plugins` قرار دهید.
2. افزونه را از منوی **افزونه‌ها** فعال کنید.

---

## کلید متا و پیشوند
- **Meta key:** `xyz_supplier_discount_percent_`
- **Prefix:** `_xyzsp`

---

## دلیل انتخاب هوک‌ها

- `woocommerce_product_options_pricing`  
  محل مناسب برای افزودن فیلدهای مرتبط با قیمت در تب قیمت محصول است.

- `woocommerce_process_product_meta`  
  مقادیر واردشده توسط نقش‌های مجاز در متای محصول ذخیره یا حذف می‌شوند.

- `woocommerce_product_after_variable_attributes`  
  امکان تنظیم درصد تخفیف به‌صورت مجزا برای هر واریاسیون فراهم می‌شود.

- `woocommerce_save_product_variation`  
  مقادیر واریاسیون‌ها به‌درستی و امن ذخیره خواهند شد.

- `woocommerce_product_get_price`, `woocommerce_product_get_regular_price`, `woocommerce_product_get_sale_price`  
  - **دلیل:** این فیلترها قیمت محصول را قبل از نمایش یا محاسبات داخلی تغییر می‌دهند تا تخفیف اعمال شود.  
  - **نتیجه:** کاربران با نقش تأمین‌کننده قیمت کاهش‌یافته را مشاهده می‌کنند.

- `woocommerce_get_price_html`  
  - **دلیل:** برای کنترل نحوه نمایش قیمت و نشان دادن قیمت قبل و بعد از تخفیف.  
  - **نتیجه:** قیمت اصلی و تخفیف‌خورده برای تأمین‌کننده به‌صورت واضح نمایش داده می‌شود.
